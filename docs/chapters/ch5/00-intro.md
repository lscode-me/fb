# Часть V. Инфраструктура хранения данных

## О чём эта глава

Эта глава написана для **системных администраторов**, **DevOps-инженеров** и всех, кому нужно понимать, как данные физически хранятся и передаются в современных системах.

### От файлов к дискам

В предыдущих главах мы работали с файлами как абстракцией: inode, права доступа, форматы данных. Но под каждым файлом лежит цепочка технологий:

```
Приложение
    ↓
Файловая система (ext4, XFS, ZFS)
    ↓
Блочное устройство (/dev/sda)
    ↓
Контроллер диска (SATA, NVMe)
    ↓
Физический носитель (SSD, HDD)
```

### Что мы изучим

1. **Архитектура накопителей** — как устроены HDD, SSD, NVMe. Почему IOPS важны для баз данных, а последовательное чтение — для видео

2. **Блочные устройства и разделы** — GPT vs MBR, схемы партиционирования, LVM для гибкого управления

3. **Файловые системы** — ext4, XFS, Btrfs, ZFS. Журналирование, снапшоты, RAID, дедупликация

4. **Сетевое хранение** — NFS, SMB/CIFS, iSCSI. Как монтировать удалённые файловые системы

5. **Облачное хранение** — S3-совместимые API, объектные хранилища, CDN

### Практическая ценность

Эта глава поможет:

- Выбрать правильную файловую систему для задачи
- Понять, почему база данных тормозит на HDD
- Настроить LVM для расширения дисков без простоя
- Спроектировать схему хранения для production-системы

---

??? example "Попробуйте сами: задания по Части V"
    Эти задания объединяют материал нескольких глав. Выполняйте после прочтения всей части.

    **1. Аудит хранилища (исследование)**
    Исследуйте свою систему: `lsblk`, `df -Th`, `mount`, `cat /proc/filesystems`. Составьте схему: физические диски → разделы → файловые системы → точки монтирования. Какие ФС используются и почему?

    **2. Файловая система в файле (практика)**
    Создайте файл-образ через `dd`, отформатируйте его в ext4 (или другую ФС), смонтируйте через loop device. Создайте файлы, размонуйте, исследуйте образ через `debugfs` или `fsck`. Что произойдёт, если вы повредите несколько байт образа?

    **3. Бенчмарк I/O (кодинг)**
    Напишите скрипт, который замеряет: последовательную запись (dd-like), случайное чтение 4K блоков, latency fsync. Сравните результаты на HDD vs SSD (или tmpfs vs реальный диск). Визуализируйте результаты.

    **4. Проект хранилища (сквозное задание)**
    Спроектируйте схему хранения для веб-сервиса с 10 ТБ данных: выберите ФС, схему partition/LVM, стратегию бэкапов (снапшоты), мониторинг (SMART). Обоснуйте каждое решение, ссылаясь на материал глав 34–50.
